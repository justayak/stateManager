window.State=function(){function b(a){f&&console.log("[stateManager]["+(new Date).toISOString().substring(12)+"]"+a)}function c(a,b){this._parent="undefined"===typeof b?null:b;this._states={};this._currentSubstate=null;this._isPaused=!1;this.name=a;this.onPause=this.onResume=this.onStart=this.onClose=null}var f=!1,d={},e=null;c.prototype.createSubstate=function(a){a in this._states&&b("Substate {"+a+"} is already member of {"+this.name+"} -> Overwrite");b("Create Substate {"+a+"} in State {"+this.name+
    "}");var g=new c(a,this);return this._states[a]=g};c.prototype.setSubstate=function(a,c){b("Trying to open Substate {"+a+"} in State {"+this.name+"}");if(a in this._states){this._isPaused||this.pause(c);var d=this._states[a];null!==this._currentSubstate&&this._currentSubstate.close(c);d.start(c);this._currentSubstate=d}else b("Could not find Substate {"+a+"} in State {"+this.name+"}")};c.prototype.closeSubstate=function(a){b("Trying to close Substate in State {"+this.name+"}");null!==this._currentSubstate?
    (this._currentSubstate.close(a),this.resume(a)):b("No Substate is running in in State {"+this.name+"}")};c.prototype.start=function(a){b("Start State {"+this.name+"}");null!==this.onStart&&this.onStart.call(this,a)};c.prototype.pause=function(a){b("Pause State {"+this.name+"}");this._isPaused=!0;null!==this.onPause&&this.onPause.call(this,a)};c.prototype.resume=function(a){b("Resume State {"+this.name+"}");this._isPaused=!1;null!==this.onResume&&this.onResume.call(this,a)};c.prototype.close=function(a){b("Close State {"+
    this.name+"}");null!==this.onClose&&this.onClose.call(this,a);null!==this._parent&&this._parent._isPaused&&this._parent.resume(a)};return{setLogging:function(a){f=a},Manager:{createState:function(a){b("Create State {"+a+"}");a in d&&b("Overwriting State {"+a+"}");var e=new c(a);return d[a]=e},setState:function(a){b("Try set State {"+a+"}");a in d?(null!==e&&e.close(),e=d[a],e.start()):b("Could not find State {"+a+"}")}},State:c}}();